<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
	
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="baidu-site-verification" content="o4pXUBsPyW" />
	
    <!--Description-->
    
        <meta name="description" content="To be more curious and less lazy.">
    

    <!--Author-->
    
        <meta name="author" content="Chen Dian">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="【矩阵分解】Python下基于Numpy的四种矩阵基本分解的实现"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="To be more curious and less lazy." />
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="CDPlayer&#39;s Blog"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

    <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>【矩阵分解】Python下基于Numpy的四种矩阵基本分解的实现 - CDPlayer&#39;s Blog</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="../../css/style.css">

    <!-- Google Analytics -->
    

	
	<!-- Baidu Analytics -->
    
	<script type="text/javascript">
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "https://hm.baidu.com/hm.js?{{ theme.baidu_analytics }}";
		  var s = document.getElementsByTagName("script")[0];
		  s.parentNode.insertBefore(hm, s);
		})();
	</script>


	
	<!-- star map -->
	<script type="text/javascript" color="255,255,255" opacity='0.75' zIndex="-2" count="88" src="js/canvas.js"></script>
	
	<!-- Earth -->
	<script type="text/javascript" src="//rf.revolvermaps.com/0/0/6.js?i=5mihyim0z76&amp;m=7&amp;c=66ccff&amp;cr1=ff0000&amp;f=arial&amp;l=0&amp;lx=200&amp;ly=-20&amp;hi=10" async="async"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>


<body>

<!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="../../index.html">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="../../tags">
                    Tags
                </a>
            </li>
            
            <li class="menu-item">
                <a href="../../archives">
                    Archives
                </a>
            </li>
            
            <li class="menu-item">
                <a href="../../categories">
                    Categories
                </a>
            </li>
            
            <li class="menu-item">
                <a href="../../about">
                    About
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
    </div>
</header>

        <section class="main">
            
<div class="post">

    <div class="post-header">
        <h1 class="title">
            <a href="../../articles/2016-12/【矩阵分解】Python下基于Numpy的四种矩阵基本分解的实现.html">
                【矩阵分解】Python下基于Numpy的四种矩阵基本分解的实现
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2016-12-04</span>
            
            
                <a href="#disqus_thread" class="comments">留言</a>
            
            
                <span class="category">
                    <a href="/categories/功能脚本/">功能脚本</a>
                </span>
            
        </div>
    </div>

    <div class="content">

        <!-- Gallery -->
        

		<!-- MathJax support -->
		

		
        <!-- Post Content -->
        <h3 id="0x00-需求"><a href="#0x00-需求" class="headerlink" title="0x00 需求"></a>0x00 需求</h3><p>完成课堂上讲的关于矩阵分解的<br>· LU、<br>· QR（Gram-Schmidt）<br>· Orthogonal Reduction<br>    Householder reduction<br>    Givens reduction<br>程序实现，要求一个综合程序，根据选择参数的不同，实现不同的矩阵分解。</p>
<p>反正也是要写，就顺手做成了实现类，可以import调用的那种，为了写作业方便，也设置了输出中间过程，方便拿过程分。</p>
<a id="more"></a>
<h3 id="0x01-作者"><a href="#0x01-作者" class="headerlink" title="0x01 作者"></a>0x01 作者</h3><ul>
<li>陈点 学号 201618013229031</li>
<li>个人邮箱 chendian@baidu.com</li>
<li>个人主页 blog.csdn.net/okcd00</li>
<li>Github github.com/okcd00</li>
</ul>
<h3 id="0x02-文件树"><a href="#0x02-文件树" class="headerlink" title="0x02 文件树"></a>0x02 文件树</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">E:\UCAS\矩阵分析与应用\CD_MatrixDecomp 的目录</div><div class="line"></div><div class="line">2016/11/28  23:11                27 A.txt		% 用于测试各种不同种类输入的文件</div><div class="line">2016/11/28  23:11                28 B.txt		% 用于测试非方阵进行LU分解时的文件</div><div class="line">2016/11/23  15:51                40 LU.txt		% 用于测试LU分解的输入示例</div><div class="line">2016/11/28  23:17            10,560 MatrixDecomp.py	% 主程序，python MatrixDecomp.py即可</div><div class="line">2016/11/23  15:50                27 QR.txt		% 用于测试QR分解的输入示例</div><div class="line">2016/11/27  16:01             2,606 Readme.txt		% 说明文档</div></pre></td></tr></table></figure>
<h3 id="0x03-程序输入"><a href="#0x03-程序输入" class="headerlink" title="0x03 程序输入"></a>0x03 程序输入</h3><p>封装为类，返回值实际为一个dict，在LU分解时返回的dict包含三个键值对：P,A,T，类似的QR分解时范围的是Q与R，value均为np.ndarray格式矩阵<br>在import该类进行矩阵计算的时候可以直接调用各类函数，将该类为主进程打开时会通过简单的main函数的提示信息引导展示输入输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">E:\UCAS\矩阵分析与应用\BigHomework&gt;python MatrixDecomp.py</div><div class="line">&gt; Current Selection is: &lt;Default&gt;</div><div class="line">&gt; Please show me the Matrix for Decomposition</div><div class="line">&gt; It can be a list or path to a Matrix_File</div><div class="line">&gt; Example: [[1,0],[0,1]] or &quot;A.txt&quot;</div><div class="line">The Matrix is:</div></pre></td></tr></table></figure>
<p>可直接输入形似[[1,0,0],[0,1,0],[0,0,1]]的list，也可以输入文件地址，需要注意地址应该加上引号，如”A.txt”<br>目录下提供了课件上的LU分解的实例与QR分解时使用的矩阵</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; Current Selection is: &lt;Mode&gt;</div><div class="line">&gt; Please Select Decomposition Type</div><div class="line">&gt; Example: LU GS HH or GV</div><div class="line">The Matrix&apos;s Size:</div></pre></td></tr></table></figure>
<p>此处可选择LU GS HH or GV，分别代表LU分解，Gram-Schmidt、Householder、与Givens的QR分解</p>
<h3 id="0x04-参数"><a href="#0x04-参数" class="headerlink" title="0x04 参数"></a>0x04 参数</h3><p>mdp.Show_Process = False<br>（强烈推荐调成True跑一下看看效果，也不枉coding那么久QvQ）<br>该参数控制是否输出形似如下形式的中间计算过程：<br>Calculation[0]:<br>Q = xxx<br>R = xxx<br>Calculation[1]:<br>Q = xxx<br>R = xxx<br>Calculation[x]:</p>
<p>mdp.setMatA(mdp.getInput(‘Default’))<br>目前已经编码的合法参数为default, random, mode，其中random为随机生成矩阵，根据提示输入矩阵的行列数，值为0-9之间随机选择</p>
<h3 id="0x05-程序源码"><a href="#0x05-程序源码" class="headerlink" title="0x05 程序源码"></a>0x05 程序源码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#coding=utf8</span></div><div class="line"><span class="comment"># ========================================================</span></div><div class="line"><span class="comment">#   Copyright (C) 2016 All rights reserved.</span></div><div class="line"><span class="comment">#   </span></div><div class="line"><span class="comment">#   filename : MatrixDecomp.py</span></div><div class="line"><span class="comment">#   author   : okcd00 / chendian@baidu.com</span></div><div class="line"><span class="comment">#   date     : 2016-11-23</span></div><div class="line"><span class="comment">#   desc     : Matrix Decomposition</span></div><div class="line"><span class="comment">#   homepage : blog.csdn.net/okcd00</span></div><div class="line"><span class="comment"># ======================================================== </span></div><div class="line"></div><div class="line"><span class="comment"># Basic package</span></div><div class="line"><span class="keyword">import</span> random</div><div class="line"><span class="keyword">import</span> os,sys,time</div><div class="line"></div><div class="line"><span class="comment"># Numpy for Matrix Calculation</span></div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> linalg <span class="keyword">as</span> La</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MatrixDecomp</span>:</span></div><div class="line">    </div><div class="line">    Time = <span class="number">0</span></div><div class="line">    Mode = <span class="string">"NULL"</span> <span class="comment"># LU QR(Gram-Schmidt\HouseHolder\Given)</span></div><div class="line">    MatA = <span class="string">"No Input"</span> <span class="comment"># Matrix_A for Calculation</span></div><div class="line">    bak_MatA = <span class="string">"temp"</span> <span class="comment"># Matrix_A Back_Up</span></div><div class="line">    Show_Process = <span class="keyword">False</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.Time = time.localtime(time.time())</div><div class="line">            </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setMatA</span><span class="params">(self, inp)</span>:</span></div><div class="line">        <span class="comment"># Judge the type of inp, then achieve the Matrix</span></div><div class="line">        <span class="keyword">if</span> isinstance(inp, np.ndarray):</div><div class="line">            self.MatA = inp</div><div class="line">        <span class="keyword">elif</span> isinstance(inp, list):</div><div class="line">            self.MatA = np.array(inp)</div><div class="line">        <span class="keyword">elif</span> isinstance(inp, str):</div><div class="line">            <span class="keyword">if</span> os.path.exists(inp): </div><div class="line">                self.MatA = np.array(self.readFile(inp))</div><div class="line">            <span class="keyword">elif</span> os.path.exists(inp + <span class="string">'.txt'</span>):</div><div class="line">                self.MatA = np.array(self.readFile(inp + <span class="string">'.txt'</span>))</div><div class="line">        <span class="keyword">else</span>: </div><div class="line">            <span class="keyword">print</span> <span class="string">"Invalid Input"</span></div><div class="line">        self.bak_MatA = self.MatA</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">MatDecomp</span><span class="params">(self, inp)</span>:</span></div><div class="line">        self.Mode = inp</div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            <span class="keyword">if</span> inp.upper() == <span class="string">"LU"</span>: <span class="keyword">return</span> self.LU_Decomp(self.MatA)</div><div class="line">            <span class="keyword">if</span> inp.upper() == <span class="string">"GS"</span>: <span class="keyword">return</span> self.GS_Decomp(self.MatA)</div><div class="line">            <span class="keyword">if</span> inp.upper() == <span class="string">"HH"</span>: <span class="keyword">return</span> self.HH_Decomp(self.MatA)</div><div class="line">            <span class="keyword">if</span> inp.upper() == <span class="string">"GV"</span>: <span class="keyword">return</span> self.GV_Decomp(self.MatA)</div><div class="line">            <span class="keyword">return</span> <span class="string">"Invalid Decomp Type. (LU/GS/HH/GV)"</span></div><div class="line">        <span class="keyword">except</span> Exception,e:</div><div class="line">            <span class="keyword">return</span> <span class="string">"Decomposition Error for %s"</span> % str(e)</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Row_Swap</span><span class="params">(self, mat, ra, rb)</span>:</span></div><div class="line">        ret = mat</div><div class="line">        <span class="keyword">if</span> mat.ndim == <span class="number">1</span>:</div><div class="line">            ret[ra], ret[rb] = mat[rb], mat[ra]</div><div class="line">        <span class="keyword">if</span> mat.ndim == <span class="number">2</span>:</div><div class="line">            ret[[ra, rb],:] = mat[[rb, ra],:]</div><div class="line">        <span class="keyword">return</span> ret</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Col_Swap</span><span class="params">(self, mat, ca, cb)</span>:</span></div><div class="line">        ret = mat</div><div class="line">        <span class="keyword">if</span> mat.ndim == <span class="number">1</span>:</div><div class="line">            ret[ca], ret[cb] = mat[cb], mat[ca]</div><div class="line">        <span class="keyword">if</span> mat.ndim == <span class="number">2</span>:</div><div class="line">            ret[:,[ca, cb]] = mat[:,[cb, ca]]</div><div class="line">        <span class="keyword">return</span> ret</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">MaxLine</span><span class="params">(self, colomn, row)</span>:</span></div><div class="line">        ret = row</div><div class="line">        <span class="keyword">for</span> idx <span class="keyword">in</span> range(row, colomn.__len__()):</div><div class="line">            <span class="keyword">if</span> abs(colomn[idx]) &gt; abs(colomn[ret]):</div><div class="line">                ret = idx</div><div class="line">        <span class="keyword">return</span> ret</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">LU_Operation</span><span class="params">(self, A, cur)</span>:</span></div><div class="line">        (rSize, cSize) = A.shape</div><div class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> range(cur+<span class="number">1</span>, rSize):</div><div class="line">            A[r][cur] = A[r][cur] / A[cur][cur]</div><div class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> range(cur+<span class="number">1</span>, cSize):</div><div class="line">                A[r][c] = A[r][c] - A[r][cur] * A[cur][c]</div><div class="line">        <span class="keyword">return</span> A</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">LU_GetAns</span><span class="params">(self, P1D, A)</span>:</span></div><div class="line">        (rSize, cSize) = A.shape</div><div class="line">        <span class="comment"># Need to transform P from 1D to 2D</span></div><div class="line">        P = np.zeros([rSize, rSize])</div><div class="line">        <span class="keyword">for</span> idx <span class="keyword">in</span> range(rSize):</div><div class="line">            P[idx][P1D[idx]<span class="number">-1</span>] = <span class="number">1</span></div><div class="line">        L = np.eye(rSize, cSize)</div><div class="line">        U = np.zeros([rSize, cSize])</div><div class="line">        <span class="comment"># Split MatrixA into L-Lower &amp; U-Upper</span></div><div class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> range(rSize):</div><div class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> range(cSize):</div><div class="line">                <span class="keyword">if</span> r &lt;= c : U[r][c] = A[r][c]</div><div class="line">                <span class="keyword">else</span> : L[r][c] = A[r][c]</div><div class="line">        <span class="keyword">return</span> &#123;<span class="string">'P'</span>:P, <span class="string">'L'</span>:L, <span class="string">'U'</span>:U&#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">LU_Decomp</span><span class="params">(self, A)</span>:</span> <span class="comment"># PA = LU</span></div><div class="line">        (rSize, cSize) = A.shape</div><div class="line">        <span class="keyword">if</span> rSize!=cSize :</div><div class="line">            <span class="keyword">print</span> <span class="string">"&gt; LU_Decomp needs a Nonsingular Square Matrix."</span></div><div class="line">            <span class="keyword">print</span> <span class="string">"&gt; Extend Matrix into a Square Matrix filled by zero."</span></div><div class="line">            Size = max(rSize, cSize)</div><div class="line">            Zero = np.zeros([Size,Size])</div><div class="line">            Zero[:rSize,:cSize] = np.copy(A)</div><div class="line">            A, (rSize, cSize) = np.copy(Zero), (Size, Size)</div><div class="line">            <span class="keyword">print</span> <span class="string">"&gt; Current Matrix_A = \n"</span>, A</div><div class="line">        P = np.arange(rSize) + <span class="number">1</span></div><div class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> range(rSize):</div><div class="line">            <span class="comment"># Swap MaxLine(current_Colomn's Max abs_Value) to the top</span></div><div class="line">            idxML = self.MaxLine(A[:,r], r)</div><div class="line">            A = self.Row_Swap(A, idxML, r)</div><div class="line">            P = self.Col_Swap(P, idxML, r)</div><div class="line">            A = self.LU_Operation(A, r)</div><div class="line">            <span class="keyword">if</span> self.Show_Process:</div><div class="line">                <span class="keyword">print</span> <span class="string">'Calculation[%d]:\nP = '</span> % r, P, <span class="string">'^T\nA = \n'</span>, A</div><div class="line">        <span class="keyword">return</span> self.LU_GetAns(P,A)</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GS_Decomp</span><span class="params">(self, A)</span>:</span> <span class="comment"># A = QR</span></div><div class="line">        (rSize, cSize) = A.shape</div><div class="line">        Q, R = np.copy(A), np.zeros([rSize, cSize])</div><div class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> range(cSize):</div><div class="line">            <span class="keyword">for</span> r <span class="keyword">in</span> range(c):</div><div class="line">                <span class="keyword">if</span> r &lt; c:</div><div class="line">                    <span class="comment"># R_rc = qr^T * Ac</span></div><div class="line">                    R[r][c] = np.dot(np.transpose(Q[:,r]), A[:,c])</div><div class="line">                    Q[:,c] = Q[:,c] - R[r][c] * Q[:,r]</div><div class="line">            R[c][c] = La.norm(Q[:,c])</div><div class="line">            Q[:,c] = Q[:,c] / R[c][c]</div><div class="line">            <span class="keyword">if</span> self.Show_Process:</div><div class="line">                <span class="keyword">print</span> <span class="string">'Calculation[%d]:\nQ = \n'</span> % c, Q, <span class="string">'\nR = \n'</span>, R</div><div class="line">        <span class="keyword">return</span> &#123;<span class="string">'Q'</span>:Q, <span class="string">'R'</span>:R&#125;</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">HH_Decomp</span><span class="params">(self, A)</span>:</span> <span class="comment"># A = QR / PA = T</span></div><div class="line">        (rSize, cSize) = A.shape</div><div class="line">        P = np.eye(rSize, cSize)</div><div class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> range(cSize):</div><div class="line">            MatA, MatU = np.copy(A[c:,c:]), np.copy(A[c:,c]) <span class="comment"># MatU = MatA[:,0]</span></div><div class="line">            MatU[<span class="number">0</span>] = MatU[<span class="number">0</span>]+La.norm(MatU) <span class="keyword">if</span> MatU[<span class="number">0</span>]&lt;<span class="number">0</span> <span class="keyword">else</span> MatU[<span class="number">0</span>]-La.norm(MatU)</div><div class="line">            MatU.shape = (<span class="number">1</span>, MatU.shape[<span class="number">0</span>])</div><div class="line">            MatU = np.transpose(MatU)</div><div class="line">            MatR = np.eye(MatU.shape[<span class="number">0</span>])</div><div class="line">            <span class="comment"># Transposing a 1-D array returns an unchanged view of the original array / Note for np.transpose</span></div><div class="line">            UTU = np.dot(np.transpose(MatU), MatU)</div><div class="line">            MatR = MatR - <span class="number">2.0</span> * (</div><div class="line">                (np.dot(MatU, np.transpose(MatU)) / UTU) <span class="keyword">if</span> UTU!=<span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></div><div class="line">            )</div><div class="line">            MatA = np.dot(MatR, MatA)</div><div class="line">            R = np.eye(rSize, cSize)</div><div class="line">            R[c:,c:] = np.copy(MatR)</div><div class="line">            P = np.dot(R, P)</div><div class="line">            A[c:,c:] = np.copy(MatA)</div><div class="line">            <span class="keyword">if</span> self.Show_Process:</div><div class="line">                <span class="keyword">print</span> <span class="string">'Calculation[%d]:\nR%d = \n'</span> % (c+<span class="number">1</span>,c+<span class="number">1</span>), MatR, <span class="string">'\nR%dA%d = \n'</span> % (c+<span class="number">1</span>,c+<span class="number">1</span>), MatA, <span class="string">'\nCurrent P = \n'</span>, P</div><div class="line">        <span class="keyword">return</span> &#123;<span class="string">'Q'</span>:np.transpose(P), <span class="string">'R'</span>:A &#125;<span class="comment">#, 'T':A&#125;</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GV_Rotate</span><span class="params">(self, A, i, j)</span>:</span></div><div class="line">        (rSize, cSize) = A.shape</div><div class="line">        ret = np.eye(rSize, cSize)</div><div class="line">        upValue = sum(item**<span class="number">2</span> <span class="keyword">for</span> item <span class="keyword">in</span> A[j:i,j])</div><div class="line">        c = upValue**<span class="number">0.5</span> / (upValue + A[i][j]**<span class="number">2</span>)**<span class="number">0.5</span></div><div class="line">        s = A[i][j] / (upValue + A[i][j]**<span class="number">2</span>)**<span class="number">0.5</span></div><div class="line">        ret[i][i], ret[j][j] = c, c</div><div class="line">        ret[i][j], ret[j][i] = -s, s</div><div class="line">        <span class="keyword">return</span> ret</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GV_Decomp</span><span class="params">(self, A)</span>:</span> <span class="comment"># A = QR</span></div><div class="line">        (rSize, cSize) = A.shape</div><div class="line">        U = np.eye(rSize, cSize)</div><div class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> range(cSize):</div><div class="line">            <span class="keyword">for</span> r <span class="keyword">in</span> range(c+<span class="number">1</span>, rSize):</div><div class="line">                <span class="keyword">if</span> A[r,c] != <span class="number">0</span>:</div><div class="line">                    rot = self.GV_Rotate(A,r,c)</div><div class="line">                    U = np.dot(rot, U)</div><div class="line">                    A = np.dot(rot, A)</div><div class="line">                <span class="keyword">if</span> self.Show_Process:</div><div class="line">                    <span class="keyword">print</span> <span class="string">'Calculation[%d,%d]:\nU%d%d = \n'</span> % (r+<span class="number">1</span>,c+<span class="number">1</span>,r+<span class="number">1</span>,c+<span class="number">1</span>,), rot, <span class="string">'\nCurrent U = \n'</span>, U, <span class="string">'\nCurrent A = \n'</span>, A</div><div class="line">        <span class="keyword">return</span> &#123;<span class="string">'Q'</span>:np.transpose(U), <span class="string">'R'</span>:A &#125;</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">readFile</span><span class="params">(self, filename)</span>:</span></div><div class="line">        <span class="comment"># The Matrix File needs to be splited</span></div><div class="line">        <span class="keyword">with</span> open(filename,<span class="string">'r'</span>) <span class="keyword">as</span> f:</div><div class="line">            ret = []</div><div class="line">            lines = [ line <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines() ]</div><div class="line">            <span class="keyword">for</span> each <span class="keyword">in</span> lines :</div><div class="line">                line = [ float(num) <span class="keyword">for</span> num <span class="keyword">in</span> each.split() ]</div><div class="line">                ret.append(line)</div><div class="line">            <span class="keyword">return</span> ret      </div><div class="line">            </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getInput</span><span class="params">(self, inp=<span class="string">'Default'</span>)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">"&gt; Current Selection is: &lt;%s&gt;"</span> % inp</div><div class="line">        <span class="comment"># Get varName or filePath from console for Original Matrix</span></div><div class="line">        <span class="keyword">if</span> inp.upper() == <span class="string">'DEFAULT'</span>:</div><div class="line">            <span class="comment"># print "MatrixDecomp 1.0.7 (v1.0.7, Nov 27 2016, 22:54:40) Type \"help\" for more information."</span></div><div class="line">            <span class="keyword">print</span> <span class="string">"&gt; Please show me the Matrix for Decomposition"</span></div><div class="line">            <span class="keyword">print</span> <span class="string">"&gt; It can be a list or path to a Matrix_File"</span></div><div class="line">            <span class="keyword">print</span> <span class="string">"&gt; Example: [[1,0],[0,1]] or \"A.txt\", \"LU\" etc."</span></div><div class="line">            ret = input(<span class="string">"The Matrix is: "</span>)</div><div class="line">        <span class="keyword">elif</span> inp.upper() == <span class="string">'RANDOM'</span>:</div><div class="line">            <span class="comment"># Define constants</span></div><div class="line">            <span class="keyword">print</span> <span class="string">"&gt; Please show me the Matrix's Size, split by \',\' "</span></div><div class="line">            <span class="keyword">print</span> <span class="string">"&gt; Example: 5,3 or 7,7"</span></div><div class="line">            sz = raw_input(<span class="string">"The Matrix's Size: "</span>).split(<span class="string">','</span>)</div><div class="line">            r,c = int(sz[<span class="number">0</span>]), int(sz[<span class="number">1</span>])</div><div class="line">            <span class="comment"># Generate a target Matrix</span></div><div class="line">            ret = random.randint(<span class="number">0</span>,<span class="number">9</span>, size=(r,c))</div><div class="line">        <span class="keyword">elif</span> inp.upper() == <span class="string">'MODE'</span>:</div><div class="line">            <span class="comment"># Define constants</span></div><div class="line">            <span class="keyword">print</span> <span class="string">"&gt; Please Select Decomposition Type"</span></div><div class="line">            <span class="keyword">print</span> <span class="string">"&gt; Example: LU GS HH or GV"</span></div><div class="line">            ret = raw_input(<span class="string">"Type of the Matrix Decomposition is: "</span>)</div><div class="line">        <span class="keyword">elif</span> inp.upper() == <span class="string">'HELP'</span>:</div><div class="line">            <span class="keyword">print</span> <span class="string">"""</span></div><div class="line"><span class="string">                &gt; Help v1.0.0 Authured by Chendian / okcd00</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">                &gt; mdp.Show_Process</span></div><div class="line"><span class="string">                &gt; 该参数控制是否输出中间计算过程, 默认为False, 可在Main函数中改为True</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">                &gt; mdp.setMatA(mdp.getInput('xxx'))</span></div><div class="line"><span class="string">                &gt; 目前已经编码的合法参数为default, random, mode, help</span></div><div class="line"><span class="string">                """</span> </div><div class="line">            mdp.setMatA(mdp.getInput(<span class="string">'Default'</span>))</div><div class="line">        <span class="comment"># Can also be used for passing vars,</span></div><div class="line">        <span class="comment"># i.e. list or numpyArray</span></div><div class="line">        <span class="keyword">else</span>: ret = inp </div><div class="line">        <span class="keyword">return</span> ret</div><div class="line">        </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    np.set_printoptions(suppress=<span class="keyword">True</span>)</div><div class="line">    mdp = MatrixDecomp()</div><div class="line">    mdp.Show_Process = <span class="keyword">False</span> <span class="comment"># True, show mid-calculation</span></div><div class="line">    mdp.setMatA(mdp.getInput(<span class="string">'Default'</span>))</div><div class="line">    <span class="comment"># mdp.setMatA(mdp.getInput('RANDOM'))</span></div><div class="line">    <span class="keyword">print</span> mdp.MatA</div><div class="line">    Ans = mdp.MatDecomp(mdp.getInput(<span class="string">'Mode'</span>))</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="keyword">print</span> <span class="string">'==========Answer Sheet=========='</span></div><div class="line">        <span class="keyword">for</span> (k,v) <span class="keyword">in</span> Ans.items():</div><div class="line">            <span class="keyword">print</span> <span class="string">'&gt; Matrix'</span>, k, <span class="string">'=\n'</span>, v</div><div class="line">    <span class="keyword">except</span> Exception,e:</div><div class="line">        <span class="keyword">print</span> e, <span class="string">'\n'</span>, Ans   </div><div class="line">        </div><div class="line"><span class="string">"""</span></div><div class="line"><span class="string">E:\UCAS\矩阵分析与应用\BigHomework&gt;python MatrixDecomp.py</span></div><div class="line"><span class="string">&gt; Current Selection is: &lt;Default&gt;</span></div><div class="line"><span class="string">&gt; Please show me the Matrix for Decomposition</span></div><div class="line"><span class="string">&gt; It can be a list or path to a Matrix_File</span></div><div class="line"><span class="string">&gt; Example: [[1,0],[0,1]] or "A.txt", "LU" etc.</span></div><div class="line"><span class="string">The Matrix is: "A.txt"</span></div><div class="line"><span class="string">[[  0. -20. -14.]</span></div><div class="line"><span class="string"> [  3.  27.  -4.]</span></div><div class="line"><span class="string"> [  4.  11.  -2.]]</span></div><div class="line"><span class="string">&gt; Current Selection is: &lt;Mode&gt;</span></div><div class="line"><span class="string">&gt; Please Select Decomposition Type</span></div><div class="line"><span class="string">&gt; Example: LU GS HH or GV</span></div><div class="line"><span class="string">Type of the Matrix Decomposition is: GS</span></div><div class="line"><span class="string">==========Answer Sheet==========</span></div><div class="line"><span class="string">&gt; Matrix Q =</span></div><div class="line"><span class="string">[[ 0.   -0.8  -0.6 ]</span></div><div class="line"><span class="string"> [ 0.6   0.48 -0.64]</span></div><div class="line"><span class="string"> [ 0.8  -0.36  0.48]]</span></div><div class="line"><span class="string">&gt; Matrix R =</span></div><div class="line"><span class="string">[[  5.  25.  -4.]</span></div><div class="line"><span class="string"> [  0.  25.  10.]</span></div><div class="line"><span class="string"> [  0.   0.  10.]]</span></div><div class="line"><span class="string">"""</span></div></pre></td></tr></table></figure>
<h3 id="0xFF-测试数据"><a href="#0xFF-测试数据" class="headerlink" title="0xFF 测试数据"></a>0xFF 测试数据</h3><p>LU.txt</p>
<blockquote>
<p>1 2 -3 4<br>4 8 12 -8<br>2 3 2 1<br>-3 -1 1 -4</p>
</blockquote>
<p>QR.txt</p>
<blockquote>
<p>0 -20 -14<br>3 27 -4<br>4 11 -2</p>
</blockquote>
<p>LU.txt for non-square</p>
<blockquote>
<p>1 2 -3 4<br>4 8 12 -8<br>2 3 2 1</p>
</blockquote>

    </div>

    

    
        <div class="post-tags">
            <i class="fa fa-tags" aria-hidden="true"></i>
            <a href="/tags/Numpy/">#Numpy</a>
        </div>
    

    <!-- Comments -->
    
    <div class="comments">
        
<div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>



    </div>
    

</div>
        </section>

    </div>
</div>

</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    Coding the world, try to fetch more.
                </p>
                <script type="text/javascript" src="//rf.revolvermaps.com/0/0/6.js?i=5mihyim0z76&amp;m=7&amp;c=66ccff&amp;cr1=ff0000&amp;f=arial&amp;l=0&amp;lx=200&amp;ly=-20&amp;hi=10" async="async"></script>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="../../articles/2020-02/【HNS】试着领一下 HandShake 为开源社区发放的 HNS Coin.html">【HNS】试着领一下 HandShake 发给开源社区的 HNS Coin</a>
            </li>
            
            <li>
                <a class="footer-post" href="../../articles/2017-10/【Autograd】深入理解BP与自动求导.html">【Autograd】深入理解BP与自动求导</a>
            </li>
            
            <li>
                <a class="footer-post" href="../../articles/2017-10/【Codeforces】33th_Codeforces_Contest.html">【Codeforces】33th_Codeforces_Contest</a>
            </li>
            
            <li>
                <a class="footer-post" href="../../articles/2017-10/【Chrome-crx】键盘模拟鼠标点击网页按钮.html">【Chrome-Crx】键盘模拟鼠标点击网页按钮</a>
            </li>
            
        </ul>
    </div>



            
<div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 footer-categories">
    <h2>Categories</h2>
    <ul>
        
        <li>
            <a class="footer-post" href="../../categories/日常记录/">日常记录</a>
        </li>
        
        <li>
            <a class="footer-post" href="../../categories/解题报告/">解题报告</a>
        </li>
        
        <li>
            <a class="footer-post" href="../../categories/论文阅读/">论文阅读</a>
        </li>
        
        <li>
            <a class="footer-post" href="../../categories/机器学习/">机器学习</a>
        </li>
        
        <li>
            <a class="footer-post" href="../../categories/编程记忆/">编程记忆</a>
        </li>
        
        <li>
            <a class="footer-post" href="../../categories/功能脚本/">功能脚本</a>
        </li>
        
    </ul>
</div>

        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a href="https://github.com/okcd00/">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://twitter.com/okcd00/">
                            <span class="footer-icon-container">
                                <i class="fa fa-twitter"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    
                    
                    <li class="list-inline-item">
                        <a href="http://okcd00.oschina.io/">
                            <span class="footer-icon-container">
                                <i class="fa fa-star-half-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:okcd00@vip.qq.com">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="http://blog.csdn.net/okcd00">
                            <span class="footer-icon-container">
                                <i class="fa fa-pencil-square-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    @<a href="https://github.com/okcd00/">Dian Chen</a>. 2017 All right reserved | Redesign & Deploy <a href="blog.csdn.net/okcd00">okcd00</a> | Hexo Theme <a href="http://www.codeblocq.com/">Jonathan Klughertz</a>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->
<script src="../../js/main.js"></script>

<!-- Disqus Comments -->

<script type="text/javascript">
    var disqus_shortname = 'okcd00';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<!-- "//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js" -->
<script type="text/javascript" color="0,255,255" opacity='0.75' zIndex="-2" count="75" src='/js/canvas.js'></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>